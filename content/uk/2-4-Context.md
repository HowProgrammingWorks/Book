## 2.3. Контекст та лексичне оточення

> Область видимості (Scope)

Область видимості - частина коду, з якої "видно" ідентифікатор. Розглянемо приклад:

код

У сучасному стандарті JavaScript область видимості породжується функцією або будь-яким блоком операторів, що мають фігурні дужки {}. У Python scope породжується лише функціями. Порівняйте цей код із попереднім прикладом:

код

> Лексичний контекст (Lexical environment)

Набір ідентифікаторів доступний у локальному блоці або функції. Якщо ідентифікатор не знайдено в лексичному контексті, пошук продовжиться в батьківському контексті, адже контексти мають вкладену структуру. Якщо дійшовши до кореня ідентифікатора не знайдено, буде проведено пошук у глобальному контексті. Для JavaScript лексичні контексти обмежуються блоками '{}' і функціями, а Python — лише функціями.

Лексичний контекст чи лексичне оточення мають вкладеність, тобто крім локальних змінних у блоці, що породжує контекст, є й вищий блок зі своїм контекстом. Якщо ідентифікатор визначений у контексті, то його видно у всіх вкладеннях, якщо тільки не відбувається перекриття імен. Перекриття – це випадок, коли у вкладеному контексті теж оголошено ідентифікатор, що вже є у зовнішньому, тоді значення із зовнішнього контексту стає недоступним і ми маємо доступ лише до значення ідентифікатора з внутрішнього контексту.

> Об'єктний контекст

Об'єкт, доступний з методів і функцій через спеціальний ідентифікатор `this` теж використовується як контекст. У більшості мов програмування метод пов'язується з `this` при створенні об'єкта класу. Але JavaScript функції можуть бути прикріплені до `this` за допомогою `bind` або одноразово викликані в контексті об'єкта через `call` і `apply`. Усі функції, крім стрілочних, можуть бути пов'язані з об'єктами.

> Глобальний контекст (Global context)

Якщо ідентифікатор не знаходиться у жодному з вкладених лексичних контекстів, то буде виконано його пошук у глобальному об'єкті-довіднику, який є глобальним контекстом (JavaScript `global` або `window`).

> Побічні ефекти (Side effects)

> Функція вищого порядку (Higher-order Function)

1. Якщо функція передається в іншу функцію як аргумент, це колбек.
2. Якщо функція повертається як результат, це фабрика функцій на замиканнях.
3. Якщо функція, що повертається, має ту ж семантику, що й одержувана в аргументах, але з додатковою (розширеною) поведінкою, то це функція-обгортка.
4. Рідко буває, що функція, що повертається, не пов'язана з функцією з аргументів, або пов'язана не прямо, а також має іншу семантику і функцією-оберткою вона не є.
5. Якщо виході клас чи функція-конструктор, це фабрики класів і прототипів відповідно.

> Функція-обгортка (Wrapper)

Функція, яка обертає іншу функцію (іноді об'єкт, інтерфейс чи функціональний об'єкт), додаючи додаткову поведінку. Можна обернути цілий інтерфейс API і навіть асинхронну функцію разом з колбеками (якщо відомий контракт).
