## 2.4. Контекст и лексическое окружение

> Область видимости (Scope)

Область видимости — часть кода, из которой "виден" идентификатор. Рассмотрим пример:

```js
const level = 1;

const f = () => {
  const level = 2;
  {
    const level = 3;
    console.log(level); // 3
  }
  console.log(level); // 2
};
```

В современном стандарте `JavaScript` область видимости порождается функцией или любым блоком операторов, имеющим фигурные скобки `{}`. В `Python` scope порождается только функциями. Сравните этот код с предыдущим примером:

```py
level = 1

def f():
  level = 2
  if level == 2:
    level = 3
    print(level) // 3
  print(level) // 3

f()
```

> Лексический контекст (Lexical environment)

Набор идентификаторов, доступный в локальном блоке или функции. Если идентификатор не найден в лексическом контексте, то поиск продолжится в родительском контексте, ведь контексты имеют вложенную структуру. Если дойдя до корня идентификатор не найден, то будут проведен поиск в глобальном контексте. Для JavaScript лексические контексты ограничиваются блоками `{}` и функуциями, а для Python — только функциями.

Лексический контекст или лексическое окружение имеют вложенность, т.е. кроме локальных переменных в блоке, порождающем контекст, есть и вышестоящий блок со своим контекстом. Если идентификатор определен в вышестоящем контексте, то он виден во всех вложенных, если только не происходит перекрытия имен. Перекрытие — это случай, когда во вложенном контексте заново объявлен идентификатор, уже имеющийся во внешнем, тогда значение из внешнего контекста становится недоступно и мы можем доступаться только к внутреннему.

> Объектный контекст

Объект, доступный из методов и функций через специальный идентификатор `this` тоже используется в качестве контекста. В большинстве языков программирования, метод связывается с `this` при создании объекта класса. Но в JavaScript функции могут быть прикреплены к `this` при помощи `bind` или одноразово вызваны в контексте объекта через `call` и `apply`. Все функции, кроме стрелочных, могут быть связаны с объектами.

> Глобальный контекст (Global context)

Если идентификатор не находится ни в одном из вложенных лексических контекстов, то будет выполнен его поиск в глобальном объекте-справочнике, который является глобальным контекстом (в JavaScript `global` или `window`).
